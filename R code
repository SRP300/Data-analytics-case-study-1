# Installing and loading packages #

if (!require("pacman")) install.packages("pacman")
library(pacman)
p_load(tidyverse, janitor, lubridate, patchwork)

# Clean Column names #

ai_impact <- read_csv("Global_AI_Content_Impact_Dataset.csv") %>%
  clean_names()


#  Revenue vs AI Adoption plot #
plot_revenue <- ggplot(ai_impact, aes(x = ai_adoption_rate_percent,
                                      y = revenue_increase_due_to_ai_percent,
                                      color = industry)) +
  # Light industry trend lines
  geom_smooth(method = "lm", se = FALSE, size = 1, alpha = 0.3) +
  
  # Bold overall trend line
  geom_smooth(aes(group = 1), method = "lm", se = FALSE,
              color = "black", size = 1.5, linetype = "solid") +
  
  labs(title = "AI Adoption vs Revenue Increase",
       subtitle = "Overall trend highlighted in black, industry trends faded",
       x = "AI Adoption Rate (%)",
       y = "Revenue Increase (%)",
       color = "Industry") +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    legend.position = "bottom"
  )

# Market Share vs AI Adoption #
plot_market <- ggplot(ai_impact, aes(x = ai_adoption_rate_percent,
                                     y = market_share_of_ai_companies_percent,
                                     color = industry)) +
  # Light industry trend lines #
  geom_smooth(method = "lm", se = FALSE, size = 1, alpha = 0.3) +
  
  # Make a Bold overall trend line #
  geom_smooth(aes(group = 1), method = "lm", se = FALSE,
              color = "black", size = 1.5, linetype = "solid") +
  
  labs(title = "AI Adoption vs Market Share",
       subtitle = "Overall trend highlighted in black, industry trends faded",
       x = "AI Adoption Rate (%)",
       y = "Market Share (%)",
       color = "Industry") +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    legend.position = "bottom"
  )

# Combine both plots into one #
final_dashboard <- (plot_revenue + plot_market) +
  plot_layout(guides = "collect") &
  theme(legend.position = "bottom")

# Print final dashboard #

print(final_dashboard)
